<!DOCTYPE html>
<html class="light" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Lecturer Attendance Marking Page (Academia.)</title>
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<link href="https://fonts.googleapis.com/css2?family=Lexend:wght@100..900&display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap" rel="stylesheet"/>
<script>
  tailwind.config = {
    darkMode: "class",
    theme: {
      extend: {
        colors: {
          "primary": "#137fec",
          "background-light": "#f6f7f8",
          "background-dark": "#101922",
        },
        fontFamily: { "display": ["Lexend"] },
        borderRadius: {
          "DEFAULT": "0.25rem", "lg": "0.5rem", "xl": "0.75rem", "full": "9999px"
        },
      },
    },
  }
</script>
<style>
  .material-symbols-outlined {
    font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
  }

  /* ── Keyframes ── */
  @keyframes fadeSlideDown {
    from { opacity: 0; transform: translateY(-18px); }
    to   { opacity: 1; transform: translateY(0); }
  }
  @keyframes fadeSlideUp {
    from { opacity: 0; transform: translateY(22px); }
    to   { opacity: 1; transform: translateY(0); }
  }
  @keyframes fadeSlideRight {
    from { opacity: 0; transform: translateX(-24px); }
    to   { opacity: 1; transform: translateX(0); }
  }
  @keyframes scaleIn {
    from { opacity: 0; transform: scale(0.93); }
    to   { opacity: 1; transform: scale(1); }
  }
  @keyframes shimmer {
    0%   { background-position: -200% center; }
    100% { background-position: 200% center; }
  }
  @keyframes pulseRing {
    0%   { box-shadow: 0 0 0 0 rgba(19,127,236,0.35); }
    70%  { box-shadow: 0 0 0 8px rgba(19,127,236,0); }
    100% { box-shadow: 0 0 0 0 rgba(19,127,236,0); }
  }
  @keyframes rowIn {
    from { opacity: 0; transform: translateX(-16px); }
    to   { opacity: 1; transform: translateX(0); }
  }
  @keyframes badgePop {
    0%   { transform: scale(0); opacity: 0; }
    70%  { transform: scale(1.2); opacity: 1; }
    100% { transform: scale(1); opacity: 1; }
  }
  @keyframes navItemIn {
    from { opacity: 0; transform: translateX(-12px); }
    to   { opacity: 1; transform: translateX(0); }
  }
  @keyframes toastSlide {
    0%   { transform: translateX(-50%) translateY(80px) scale(0.95); opacity: 0; }
    15%  { transform: translateX(-50%) translateY(0) scale(1); opacity: 1; }
    80%  { transform: translateX(-50%) translateY(0) scale(1); opacity: 1; }
    100% { transform: translateX(-50%) translateY(80px) scale(0.95); opacity: 0; }
  }
  @keyframes spin {
    to { transform: rotate(360deg); }
  }
  @keyframes ripple {
    to { transform: scale(4); opacity: 0; }
  }
  @keyframes floatBg {
    0%, 100% { transform: translateY(0) rotate(0deg); }
    50%       { transform: translateY(-14px) rotate(4deg); }
  }

  /* ── Entrance animations ── */
  aside { animation: fadeSlideRight 0.5s ease both; }
  .nav-item { animation: navItemIn 0.4s ease both; }
  .nav-item:nth-child(1) { animation-delay: 0.15s; }
  .nav-item:nth-child(2) { animation-delay: 0.25s; }
  .page-header { animation: fadeSlideDown 0.5s 0.2s ease both; }
  .filter-card { animation: scaleIn 0.45s 0.35s ease both; }
  .table-card  { animation: fadeSlideUp 0.5s 0.5s ease both; }
  .summary-bar { animation: fadeSlideUp 0.45s 1.1s ease both; opacity: 0; animation-fill-mode: both; }

  .student-row {
    animation: rowIn 0.4s ease both;
    transition: background-color 0.2s ease, box-shadow 0.2s ease;
  }
  .student-row:hover {
    background-color: rgba(19,127,236,0.04);
    box-shadow: inset 3px 0 0 #137fec;
  }
  .student-row:nth-child(1) { animation-delay: 0.6s; }
  .student-row:nth-child(2) { animation-delay: 0.72s; }
  .student-row:nth-child(3) { animation-delay: 0.84s; }
  .student-row:nth-child(4) { animation-delay: 0.96s; }
  .student-row:nth-child(5) { animation-delay: 1.08s; }

  /* ── Stat badges ── */
  .stat-badge {
    animation: badgePop 0.4s ease both;
    transition: transform 0.2s ease, box-shadow 0.2s ease;
  }
  .stat-badge:hover { transform: scale(1.06); box-shadow: 0 4px 14px rgba(0,0,0,0.08); }

  /* ── Status buttons ── */
  .status-btn {
    position: relative;
    overflow: hidden;
    transition: transform 0.15s ease, box-shadow 0.15s ease, background-color 0.2s ease, color 0.2s ease;
    cursor: pointer;
  }
  .status-btn:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
  .status-btn:active { transform: scale(0.95); }

  /* Active states */
  .status-present { background-color: rgba(34,197,94,0.18) !important; color: #15803d !important; font-weight: 700 !important; }
  .status-absent  { background-color: rgba(239,68,68,0.18) !important; color: #b91c1c !important; font-weight: 700 !important; }
  .status-late    { background-color: rgba(234,179,8,0.18)  !important; color: #92400e !important; font-weight: 700 !important; }
  .dark .status-present { background-color: rgba(34,197,94,0.28)  !important; color: #86efac !important; }
  .dark .status-absent  { background-color: rgba(239,68,68,0.28)  !important; color: #fca5a5 !important; }
  .dark .status-late    { background-color: rgba(234,179,8,0.28)   !important; color: #fde68a !important; }

  /* Ripple */
  .ripple-effect {
    position: absolute;
    border-radius: 50%;
    width: 60px; height: 60px;
    margin-top: -30px; margin-left: -30px;
    background: rgba(255,255,255,0.4);
    animation: ripple 0.5s ease-out forwards;
    pointer-events: none;
  }

  /* Save button pulse */
  .btn-save { transition: transform 0.15s, box-shadow 0.15s, background-color 0.2s; }
  .btn-save:hover { animation: pulseRing 1s infinite; transform: translateY(-1px); }
  .btn-save:active { transform: scale(0.97); }

  /* Export shimmer */
  .btn-export {
    background: linear-gradient(90deg, #fff 0%, #e8f4ff 40%, #fff 60%, #fff 100%);
    background-size: 200% auto;
    transition: background-position 0.3s ease, transform 0.15s ease;
  }
  .btn-export:hover { animation: shimmer 1.2s linear infinite; transform: translateY(-1px); }
  .dark .btn-export {
    background: linear-gradient(90deg, #1e293b 0%, #1e3a5f 40%, #1e293b 60%, #1e293b 100%);
    background-size: 200% auto;
  }

  /* Avatar */
  .avatar-ring {
    animation: pulseRing 2.8s 1.8s ease infinite;
    transition: transform 0.3s ease;
  }
  .avatar-ring:hover { transform: scale(1.12); }

  /* Floating background orbs */
  .bg-orb {
    position: fixed;
    border-radius: 50%;
    pointer-events: none;
    filter: blur(90px);
    opacity: 0.055;
    z-index: 0;
  }
  .bg-orb-1 {
    width: 420px; height: 420px;
    background: #137fec;
    top: -110px; right: -110px;
    animation: floatBg 9s ease-in-out infinite;
  }
  .bg-orb-2 {
    width: 320px; height: 320px;
    background: #22d3ee;
    bottom: -90px; left: 220px;
    animation: floatBg 11s 3s ease-in-out infinite;
  }

  /* Search focus */
  .search-wrap:focus-within {
    box-shadow: 0 0 0 2px rgba(19,127,236,0.3);
    border-radius: 0.5rem;
    transition: box-shadow 0.25s ease;
  }

  /* Bulk buttons */
  .bulk-btn {
    transition: transform 0.15s ease, box-shadow 0.15s ease, background-color 0.2s ease, color 0.2s ease;
  }
  .bulk-btn:hover { transform: translateY(-1px); box-shadow: 0 4px 10px rgba(0,0,0,0.08); }
  .bulk-btn:active { transform: scale(0.97); }

  /* Person icon */
  .person-icon { transition: background-color 0.2s ease, transform 0.2s ease, color 0.2s ease; }
  .student-row:hover .person-icon {
    background-color: rgba(19,127,236,0.18) !important;
    transform: scale(1.1);
    color: #137fec !important;
  }

  /* Dark mode toggle */
  .theme-toggle { transition: transform 0.4s ease; }
  .theme-toggle:hover { transform: rotate(22deg) scale(1.12); }

  /* Spinner */
  .spinner { animation: spin 0.7s linear infinite; }

  /* Select / date focus */
  select:focus, input[type="date"]:focus {
    box-shadow: 0 0 0 3px rgba(19,127,236,0.22) !important;
  }

  /* Toast */
  #toast {
    position: fixed;
    bottom: 32px;
    left: 50%;
    transform: translateX(-50%);
    z-index: 9999;
    display: none;
    pointer-events: none;
  }
  #toast.show {
    display: flex;
    animation: toastSlide 3s ease forwards;
  }
</style>
</head>
<body class="font-display bg-background-light dark:bg-background-dark">

<!-- Background orbs -->
<div class="bg-orb bg-orb-1"></div>
<div class="bg-orb bg-orb-2"></div>

<!-- Toast notification -->
<div id="toast" class="items-center gap-3 bg-slate-900 dark:bg-white text-white dark:text-slate-900 px-5 py-3 rounded-xl shadow-2xl text-sm font-semibold">
  <span class="material-symbols-outlined text-green-400 dark:text-green-600" style="font-size:20px;font-variation-settings:'FILL' 1;">check_circle</span>
  <span id="toast-msg">Done!</span>
</div>

<div class="relative flex h-auto min-h-screen w-full flex-col" style="z-index:1;">
<div class="flex h-full grow">

  <!-- Sidebar -->
  <aside class="flex w-64 flex-col gap-8 border-r border-slate-200 dark:border-slate-800 bg-white dark:bg-background-dark p-4">
    <div class="flex flex-col gap-4">
      <div class="flex items-center gap-3">
        <div class="avatar-ring bg-center bg-no-repeat aspect-square bg-cover rounded-full size-10 ring-2 ring-primary/30"
          style='background-image: url("https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRTvqfXRSSuXfjEPSaUAvOYfGzmvRB0jlHY8Q&s");'></div>
        <div class="flex flex-col">
          <h1 class="text-slate-900 dark:text-white text-base font-medium leading-normal">Dr. Lecturer</h1>
          <p class="text-slate-500 dark:text-slate-400 text-sm font-normal leading-normal">Lecturer</p>
        </div>
      </div>
      <nav class="flex flex-col gap-1">
        <a class="nav-item flex items-center gap-3 px-3 py-2 rounded-lg text-slate-700 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors duration-200" href="LecDASH.html">
          <span class="material-symbols-outlined text-slate-800 dark:text-slate-200" style="font-size:24px;">dashboard</span>
          <p class="text-sm font-medium leading-normal">Dashboard</p>
        </a>
        <a class="nav-item flex items-center gap-3 px-3 py-2 rounded-lg bg-primary/20 text-primary dark:bg-primary/30 dark:text-white" href="LecAttend.html" style="animation-delay:0.25s">
          <span class="material-symbols-outlined text-primary dark:text-white" style="font-variation-settings:'FILL' 1;font-size:24px;">task_alt</span>
          <p class="text-sm font-medium leading-normal">Attendance</p>
        </a>
      </nav>
    </div>
    <div class="flex flex-col gap-1 mt-auto">
      <button id="themeToggle" class="nav-item flex items-center gap-3 px-3 py-2 rounded-lg text-slate-700 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors duration-200 w-full text-left" style="animation-delay:0.35s">
        <span id="themeIcon" class="theme-toggle material-symbols-outlined text-slate-800 dark:text-slate-200" style="font-size:24px;">dark_mode</span>
        <p id="themeLabel" class="text-sm font-medium leading-normal">Dark Mode</p>
      </button>
      <a class="nav-item flex items-center gap-3 px-3 py-2 rounded-lg text-slate-700 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors duration-200" href="Lecsets.html" style="animation-delay:0.45s">
        <span class="material-symbols-outlined text-slate-800 dark:text-slate-200" style="font-size:24px;">settings</span>
        <p class="text-sm font-medium leading-normal">Settings</p>
      </a>
      <a class="nav-item flex items-center gap-3 px-3 py-2 rounded-lg text-slate-700 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors duration-200" href="#" style="animation-delay:0.55s">
        <span class="material-symbols-outlined text-slate-800 dark:text-slate-200" style="font-size:24px;">logout</span>
        <p class="text-sm font-medium leading-normal">Logout</p>
      </a>
    </div>
  </aside>

  <!-- Main -->
  <main class="flex-1 p-8">
    <div class="mx-auto max-w-5xl">

      <!-- Header -->
      <header class="page-header flex flex-wrap items-center justify-between gap-4 mb-8">
        <div class="flex flex-col gap-1">
          <p class="text-slate-900 dark:text-white text-3xl font-bold leading-tight tracking-[-0.03em]">Mark Attendance</p>
          <p class="text-slate-500 dark:text-slate-400 text-base font-normal leading-normal">Select a course and date to mark student attendance.</p>
        </div>
        <div class="flex items-center gap-2">
          <button id="exportBtn" class="btn-export flex min-w-[84px] cursor-pointer items-center justify-center gap-2 overflow-hidden rounded-lg h-10 px-4 border border-slate-300 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-800 dark:text-slate-200 text-sm font-bold leading-normal tracking-[0.015em]">
            <span class="material-symbols-outlined" style="font-size:20px;">download</span>
            <span class="truncate">Export</span>
          </button>
          <button id="saveBtn" class="btn-save flex min-w-[84px] cursor-pointer items-center justify-center gap-2 overflow-hidden rounded-lg h-10 px-4 bg-primary text-white text-sm font-bold leading-normal tracking-[0.015em]">
            <span id="saveIcon" class="material-symbols-outlined" style="font-size:20px;">save</span>
            <span id="saveLabel" class="truncate">Save Attendance</span>
          </button>
        </div>
      </header>

      <!-- Filter -->
      <section class="filter-card flex flex-wrap items-end gap-4 p-4 mb-4 bg-white dark:bg-slate-900/50 rounded-xl border border-slate-200 dark:border-slate-800">
        <label class="flex flex-col min-w-40 flex-1">
          <p class="text-slate-800 dark:text-slate-200 text-sm font-medium leading-normal pb-2">Course</p>
          <select class="form-select flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-lg text-slate-900 dark:text-white focus:outline-0 focus:ring-0 border border-slate-300 dark:border-slate-700 bg-background-light dark:bg-slate-800 focus:border-primary h-12 p-3 text-base font-normal leading-normal transition-all duration-200">
            <option>CS101: Introduction to Computer Eng</option>
            <option>PHY203: Quantum Mechanics</option>
            <option>ENG301: Advanced ALGO</option>
          </select>
        </label>
        <label class="flex flex-col min-w-40 flex-1">
          <p class="text-slate-800 dark:text-slate-200 text-sm font-medium leading-normal pb-2">Lecture Date</p>
          <input class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-lg text-slate-900 dark:text-white focus:outline-0 focus:ring-0 border border-slate-300 dark:border-slate-700 bg-background-light dark:bg-slate-800 focus:border-primary h-12 p-3 text-base font-normal leading-normal transition-all duration-200" type="date" value="2024-10-26"/>
        </label>
      </section>

      <!-- Summary badges -->
      <div class="summary-bar flex flex-wrap gap-3 mb-4">
        <div class="stat-badge flex items-center gap-2 px-4 py-2 rounded-lg bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 text-sm font-semibold text-green-700 dark:text-green-300" style="animation-delay:1.15s">
          <span class="material-symbols-outlined" style="font-size:16px;font-variation-settings:'FILL' 1;">check_circle</span>
          Present: <span id="countPresent">0</span>
        </div>
        <div class="stat-badge flex items-center gap-2 px-4 py-2 rounded-lg bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 text-sm font-semibold text-red-700 dark:text-red-300" style="animation-delay:1.25s">
          <span class="material-symbols-outlined" style="font-size:16px;font-variation-settings:'FILL' 1;">cancel</span>
          Absent: <span id="countAbsent">0</span>
        </div>
        <div class="stat-badge flex items-center gap-2 px-4 py-2 rounded-lg bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 text-sm font-semibold text-yellow-700 dark:text-yellow-300" style="animation-delay:1.35s">
          <span class="material-symbols-outlined" style="font-size:16px;font-variation-settings:'FILL' 1;">schedule</span>
          Late: <span id="countLate">0</span>
        </div>
        <div class="stat-badge flex items-center gap-2 px-4 py-2 rounded-lg bg-slate-50 dark:bg-slate-800/50 border border-slate-200 dark:border-slate-700 text-sm font-semibold text-slate-600 dark:text-slate-400" style="animation-delay:1.45s">
          <span class="material-symbols-outlined" style="font-size:16px;">group</span>
          Total: <span id="countTotal">0</span>
        </div>
      </div>

      <!-- Table Card -->
      <div class="table-card bg-white dark:bg-slate-900/50 rounded-xl border border-slate-200 dark:border-slate-800">
        <div class="flex flex-wrap justify-between items-center gap-4 p-4 border-b border-slate-200 dark:border-slate-800">
          <div class="flex-1 min-w-64">
            <div class="search-wrap flex h-10 w-full rounded-lg overflow-hidden">
              <div class="text-slate-500 dark:text-slate-400 flex border-none bg-background-light dark:bg-slate-800 items-center justify-center pl-3 rounded-l-lg">
                <span class="material-symbols-outlined" style="font-size:24px;">search</span>
              </div>
              <input id="searchInput" class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-r-lg text-slate-900 dark:text-white focus:outline-0 focus:ring-0 border-none bg-background-light dark:bg-slate-800 h-full placeholder:text-slate-500 dark:placeholder:text-slate-400 px-4 pl-2 text-base font-normal leading-normal" placeholder="Search by student name or ID"/>
            </div>
          </div>
          <div class="flex items-center gap-3 flex-wrap">
            <button id="markAllPresent" class="bulk-btn flex cursor-pointer items-center justify-center gap-2 overflow-hidden rounded-lg h-10 px-4 bg-slate-200 dark:bg-slate-800 text-slate-800 dark:text-slate-200 text-sm font-bold leading-normal tracking-[0.015em] hover:bg-green-100 dark:hover:bg-green-900/30 hover:text-green-700 dark:hover:text-green-300">
              <span class="material-symbols-outlined" style="font-size:18px;">done_all</span>
              <span class="truncate">Mark All Present</span>
            </button>
            <button id="markAllAbsent" class="bulk-btn flex cursor-pointer items-center justify-center gap-2 overflow-hidden rounded-lg h-10 px-4 bg-slate-200 dark:bg-slate-800 text-slate-800 dark:text-slate-200 text-sm font-bold leading-normal tracking-[0.015em] hover:bg-red-100 dark:hover:bg-red-900/30 hover:text-red-700 dark:hover:text-red-300">
              <span class="material-symbols-outlined" style="font-size:18px;">remove_done</span>
              <span class="truncate">Mark All Absent</span>
            </button>
          </div>
        </div>

        <div class="overflow-x-auto">
          <table class="w-full text-left">
            <thead class="border-b border-slate-200 dark:border-slate-800 bg-slate-50/60 dark:bg-slate-800/30">
              <tr>
                <th class="p-4 text-sm font-semibold text-slate-500 dark:text-slate-400">Student ID</th>
                <th class="p-4 text-sm font-semibold text-slate-500 dark:text-slate-400">Name</th>
                <th class="p-4 text-sm font-semibold text-slate-500 dark:text-slate-400 w-[350px]">Status</th>
              </tr>
            </thead>
            <tbody id="studentTable"></tbody>
          </table>
        </div>
      </div>

    </div>
  </main>
</div>
</div>

<script>
  const students = [
    { id: '#STU1001', name: 'Sarah Johnson',   status: 'present' },
    { id: '#STU1002', name: 'Michael Chen',    status: 'present' },
    { id: '#STU1003', name: 'Emily Rodriguez', status: 'absent'  },
    { id: '#STU1004', name: 'David Lee',       status: 'late'    },
    { id: '#STU1005', name: 'Jessica Wang',    status: 'present' },
  ];

  function renderTable(filter = '') {
    const tbody = document.getElementById('studentTable');
    tbody.innerHTML = '';
    const lf = filter.toLowerCase();
    const filtered = students.filter(s =>
      s.name.toLowerCase().includes(lf) || s.id.toLowerCase().includes(lf)
    );
    if (!filtered.length) {
      tbody.innerHTML = `<tr><td colspan="3" class="p-10 text-center text-slate-400 dark:text-slate-500 text-sm">No students found.</td></tr>`;
      updateCounts(); return;
    }
    filtered.forEach((s, i) => {
      const idx = students.indexOf(s);
      const btnClass = (st) => {
        let base = 'status-btn flex-1 py-2 px-4 rounded-lg';
        if (s.status === st) {
          if (st === 'present') return base + ' status-present';
          if (st === 'absent')  return base + ' status-absent';
          if (st === 'late')    return base + ' status-late';
        }
        return base + ' text-slate-600 dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-slate-700';
      };
      const tr = document.createElement('tr');
      tr.className = 'student-row border-b border-slate-200 dark:border-slate-800 last:border-b-0';
      tr.style.animationDelay = (0.6 + i * 0.12) + 's';
      tr.innerHTML = `
        <td class="p-4 text-sm font-medium text-slate-600 dark:text-slate-300">${s.id}</td>
        <td class="p-4 text-sm font-medium text-slate-900 dark:text-white">
          <div class="flex items-center gap-3">
            <span class="person-icon material-symbols-outlined flex items-center justify-center rounded-full size-8 bg-slate-200 dark:bg-slate-700 text-slate-500 dark:text-slate-400" style="font-size:20px;line-height:2rem;">person</span>
            <span>${s.name}</span>
          </div>
        </td>
        <td class="p-4">
          <div class="flex gap-2 text-sm font-medium">
            <button data-idx="${idx}" data-status="present" class="${btnClass('present')}">Present</button>
            <button data-idx="${idx}" data-status="absent"  class="${btnClass('absent')}">Absent</button>
            <button data-idx="${idx}" data-status="late"    class="${btnClass('late')}">Late</button>
          </div>
        </td>`;
      tbody.appendChild(tr);
    });
    updateCounts();
  }

  function updateCounts() {
    document.getElementById('countPresent').textContent = students.filter(s=>s.status==='present').length;
    document.getElementById('countAbsent').textContent  = students.filter(s=>s.status==='absent').length;
    document.getElementById('countLate').textContent    = students.filter(s=>s.status==='late').length;
    document.getElementById('countTotal').textContent   = students.length;
  }

  // Status click with ripple
  document.getElementById('studentTable').addEventListener('click', e => {
    const btn = e.target.closest('[data-status]');
    if (!btn) return;
    students[parseInt(btn.dataset.idx)].status = btn.dataset.status;

    // Ripple effect
    const rect = btn.getBoundingClientRect();
    const r = document.createElement('span');
    r.className = 'ripple-effect';
    r.style.left = (e.clientX - rect.left) + 'px';
    r.style.top  = (e.clientY - rect.top)  + 'px';
    btn.appendChild(r);
    r.addEventListener('animationend', () => r.remove());

    renderTable(document.getElementById('searchInput').value);
  });

  document.getElementById('searchInput').addEventListener('input', e => renderTable(e.target.value));

  document.getElementById('markAllPresent').addEventListener('click', () => {
    students.forEach(s => s.status = 'present');
    renderTable(document.getElementById('searchInput').value);
    showToast('All students marked present!');
  });
  document.getElementById('markAllAbsent').addEventListener('click', () => {
    students.forEach(s => s.status = 'absent');
    renderTable(document.getElementById('searchInput').value);
    showToast('All students marked absent!');
  });

  document.getElementById('saveBtn').addEventListener('click', () => {
    const icon = document.getElementById('saveIcon');
    const label = document.getElementById('saveLabel');
    icon.className = 'spinner material-symbols-outlined';
    icon.textContent = 'sync';
    label.textContent = 'Saving…';
    setTimeout(() => {
      icon.className = 'material-symbols-outlined';
      icon.textContent = 'check';
      label.textContent = 'Saved!';
      showToast('Attendance saved successfully!');
      setTimeout(() => { icon.textContent = 'save'; label.textContent = 'Save Attendance'; }, 2200);
    }, 1200);
  });

  document.getElementById('exportBtn').addEventListener('click', () => showToast('Exporting attendance data…'));

  function showToast(msg) {
    const toast = document.getElementById('toast');
    document.getElementById('toast-msg').textContent = msg;
    toast.classList.remove('show');
    void toast.offsetWidth;
    toast.classList.add('show');
    toast.addEventListener('animationend', () => toast.classList.remove('show'), { once: true });
  }

  // Dark mode
  const html = document.documentElement;
  document.getElementById('themeToggle').addEventListener('click', () => {
    html.classList.toggle('dark');
    const isDark = html.classList.contains('dark');
    document.getElementById('themeIcon').textContent  = isDark ? 'light_mode' : 'dark_mode';
    document.getElementById('themeLabel').textContent = isDark ? 'Light Mode' : 'Dark Mode';
  });

  renderTable();
</script>
</body>
</html>